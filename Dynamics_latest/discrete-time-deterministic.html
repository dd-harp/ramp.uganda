<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.1 Discrete Time, Deterministic | Applied Dynamics for Robust Analytics and Adaptive Malaria Control</title>
  <meta name="description" content="2.1 Discrete Time, Deterministic | Applied Dynamics for Robust Analytics and Adaptive Malaria Control" />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="2.1 Discrete Time, Deterministic | Applied Dynamics for Robust Analytics and Adaptive Malaria Control" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.1 Discrete Time, Deterministic | Applied Dynamics for Robust Analytics and Adaptive Malaria Control" />
  
  
  

<meta name="author" content="David L. Smith and the RAMP Team" />


<meta name="date" content="2024-05-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="basic-malaria-models.html"/>
<link rel="next" href="continuous-time-deterministic.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Foreword</a>
<ul>
<li class="chapter" data-level="" data-path="contributors.html"><a href="contributors.html"><i class="fa fa-check"></i>Contributors</a></li>
</ul></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="the-prevention-of-malaria.html"><a href="the-prevention-of-malaria.html"><i class="fa fa-check"></i><b>1</b> The Prevention of Malaria</a>
<ul>
<li class="chapter" data-level="1.1" data-path="the-quantitative-approach.html"><a href="the-quantitative-approach.html"><i class="fa fa-check"></i><b>1.1</b> The Quantitative Approach</a></li>
<li class="chapter" data-level="1.2" data-path="larval-source-management.html"><a href="larval-source-management.html"><i class="fa fa-check"></i><b>1.2</b> Larval Source Management</a></li>
<li class="chapter" data-level="1.3" data-path="malaria-population-dynamics.html"><a href="malaria-population-dynamics.html"><i class="fa fa-check"></i><b>1.3</b> Malaria Population Dynamics</a></li>
<li class="chapter" data-level="1.4" data-path="measuring-transmission.html"><a href="measuring-transmission.html"><i class="fa fa-check"></i><b>1.4</b> Measuring Transmission</a></li>
<li class="chapter" data-level="1.5" data-path="the-study-of-epidemics.html"><a href="the-study-of-epidemics.html"><i class="fa fa-check"></i><b>1.5</b> The Study of Epidemics</a></li>
<li class="chapter" data-level="1.6" data-path="mathematical-epidemiology.html"><a href="mathematical-epidemiology.html"><i class="fa fa-check"></i><b>1.6</b> Mathematical Epidemiology</a></li>
<li class="chapter" data-level="1.7" data-path="approaching-complexity.html"><a href="approaching-complexity.html"><i class="fa fa-check"></i><b>1.7</b> Approaching Complexity</a></li>
<li class="chapter" data-level="1.8" data-path="historical-notes.html"><a href="historical-notes.html"><i class="fa fa-check"></i><b>1.8</b> Historical Notes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basic-malaria-models.html"><a href="basic-malaria-models.html"><i class="fa fa-check"></i><b>2</b> Basic Malaria Models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="discrete-time-deterministic.html"><a href="discrete-time-deterministic.html"><i class="fa fa-check"></i><b>2.1</b> Discrete Time, Deterministic</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="discrete-time-deterministic.html"><a href="discrete-time-deterministic.html#variables"><i class="fa fa-check"></i><b>2.1.1</b> Variables</a></li>
<li class="chapter" data-level="2.1.2" data-path="discrete-time-deterministic.html"><a href="discrete-time-deterministic.html#initial-conditions"><i class="fa fa-check"></i><b>2.1.2</b> Initial Conditions</a></li>
<li class="chapter" data-level="2.1.3" data-path="discrete-time-deterministic.html"><a href="discrete-time-deterministic.html#parameters"><i class="fa fa-check"></i><b>2.1.3</b> Parameters</a></li>
<li class="chapter" data-level="2.1.4" data-path="discrete-time-deterministic.html"><a href="discrete-time-deterministic.html#equations"><i class="fa fa-check"></i><b>2.1.4</b> Equations</a></li>
<li class="chapter" data-level="2.1.5" data-path="discrete-time-deterministic.html"><a href="discrete-time-deterministic.html#simulation"><i class="fa fa-check"></i><b>2.1.5</b> Simulation</a></li>
<li class="chapter" data-level="2.1.6" data-path="discrete-time-deterministic.html"><a href="discrete-time-deterministic.html#analysis"><i class="fa fa-check"></i><b>2.1.6</b> Analysis</a></li>
<li class="chapter" data-level="2.1.7" data-path="discrete-time-deterministic.html"><a href="discrete-time-deterministic.html#verification"><i class="fa fa-check"></i><b>2.1.7</b> Verification</a></li>
<li class="chapter" data-level="2.1.8" data-path="discrete-time-deterministic.html"><a href="discrete-time-deterministic.html#packaging-workflows"><i class="fa fa-check"></i><b>2.1.8</b> Packaging Workflows</a></li>
<li class="chapter" data-level="2.1.9" data-path="discrete-time-deterministic.html"><a href="discrete-time-deterministic.html#thresholds"><i class="fa fa-check"></i><b>2.1.9</b> Thresholds</a></li>
<li class="chapter" data-level="2.1.10" data-path="discrete-time-deterministic.html"><a href="discrete-time-deterministic.html#numerical-stability"><i class="fa fa-check"></i><b>2.1.10</b> Numerical Stability</a></li>
<li class="chapter" data-level="2.1.11" data-path="discrete-time-deterministic.html"><a href="discrete-time-deterministic.html#notes"><i class="fa fa-check"></i><b>2.1.11</b> Notes</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="continuous-time-deterministic.html"><a href="continuous-time-deterministic.html"><i class="fa fa-check"></i><b>2.2</b> Continuous Time, Deterministic</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="continuous-time-deterministic.html"><a href="continuous-time-deterministic.html#variables-and-initial-conditions"><i class="fa fa-check"></i><b>2.2.1</b> Variables and Initial Conditions</a></li>
<li class="chapter" data-level="2.2.2" data-path="continuous-time-deterministic.html"><a href="continuous-time-deterministic.html#parameters-1"><i class="fa fa-check"></i><b>2.2.2</b> Parameters</a></li>
<li class="chapter" data-level="2.2.3" data-path="continuous-time-deterministic.html"><a href="continuous-time-deterministic.html#equations-1"><i class="fa fa-check"></i><b>2.2.3</b> Equations</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="discrete-time-stochastic.html"><a href="discrete-time-stochastic.html"><i class="fa fa-check"></i><b>2.3</b> Discrete Time, Stochastic</a></li>
<li class="chapter" data-level="2.4" data-path="continuous-time-stochastic.html"><a href="continuous-time-stochastic.html"><i class="fa fa-check"></i><b>2.4</b> Continuous Time, Stochastic</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="continuous-time-stochastic.html"><a href="continuous-time-stochastic.html#deterministic"><i class="fa fa-check"></i><b>2.4.1</b> Deterministic</a></li>
<li class="chapter" data-level="2.4.2" data-path="continuous-time-stochastic.html"><a href="continuous-time-stochastic.html#stochastic"><i class="fa fa-check"></i><b>2.4.2</b> Stochastic</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="what-is-a-model.html"><a href="what-is-a-model.html"><i class="fa fa-check"></i><b>2.5</b> What is a Model?</a></li>
<li class="chapter" data-level="2.6" data-path="historical-notes-1.html"><a href="historical-notes-1.html"><i class="fa fa-check"></i><b>2.6</b> Historical Notes</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="macdonalds-model.html"><a href="macdonalds-model.html"><i class="fa fa-check"></i><b>3</b> Macdonald’s Model</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-model.html"><a href="the-model.html"><i class="fa fa-check"></i><b>3.1</b> The Model</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="the-model.html"><a href="the-model.html#superinfection"><i class="fa fa-check"></i><b>3.1.1</b> Superinfection</a></li>
<li class="chapter" data-level="3.1.2" data-path="the-model.html"><a href="the-model.html#the-sporozoite-rate"><i class="fa fa-check"></i><b>3.1.2</b> The Sporozoite Rate</a></li>
<li class="chapter" data-level="3.1.3" data-path="the-model.html"><a href="the-model.html#variables-1"><i class="fa fa-check"></i><b>3.1.3</b> Variables</a></li>
<li class="chapter" data-level="3.1.4" data-path="the-model.html"><a href="the-model.html#parameters-2"><i class="fa fa-check"></i><b>3.1.4</b> Parameters</a></li>
<li class="chapter" data-level="3.1.5" data-path="the-model.html"><a href="the-model.html#equations-2"><i class="fa fa-check"></i><b>3.1.5</b> Equations</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-basic-reproductive-number.html"><a href="the-basic-reproductive-number.html"><i class="fa fa-check"></i><b>3.2</b> The Basic Reproductive Number</a></li>
<li class="chapter" data-level="3.3" data-path="sensitivity-to-parameters.html"><a href="sensitivity-to-parameters.html"><i class="fa fa-check"></i><b>3.3</b> Sensitivity to Parameters</a></li>
<li class="chapter" data-level="3.4" data-path="the-classification-of-transmission.html"><a href="the-classification-of-transmission.html"><i class="fa fa-check"></i><b>3.4</b> The Classification of Transmission</a></li>
<li class="chapter" data-level="3.5" data-path="historical-notes-2.html"><a href="historical-notes-2.html"><i class="fa fa-check"></i><b>3.5</b> Historical Notes</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="historical-notes-2.html"><a href="historical-notes-2.html#george-macdonald"><i class="fa fa-check"></i><b>3.5.1</b> George Macdonald</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="measuring-malaria.html"><a href="measuring-malaria.html"><i class="fa fa-check"></i><b>4</b> Measuring Malaria</a>
<ul>
<li class="chapter" data-level="4.1" data-path="infection.html"><a href="infection.html"><i class="fa fa-check"></i><b>4.1</b> Infection</a></li>
<li class="chapter" data-level="4.2" data-path="malaria-incidence.html"><a href="malaria-incidence.html"><i class="fa fa-check"></i><b>4.2</b> Malaria Incidence</a></li>
<li class="chapter" data-level="4.3" data-path="exposure-risk.html"><a href="exposure-risk.html"><i class="fa fa-check"></i><b>4.3</b> Exposure Risk</a></li>
<li class="chapter" data-level="4.4" data-path="mosquito-bionomics.html"><a href="mosquito-bionomics.html"><i class="fa fa-check"></i><b>4.4</b> Mosquito Bionomics</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="malaria-control.html"><a href="malaria-control.html"><i class="fa fa-check"></i><b>5</b> Malaria Control</a>
<ul>
<li class="chapter" data-level="5.1" data-path="sensitivity-to-parameters-1.html"><a href="sensitivity-to-parameters-1.html"><i class="fa fa-check"></i><b>5.1</b> Sensitivity to Parameters</a></li>
</ul></li>
<li class="part"><span><b>II Malaria Modeling</b></span></li>
<li class="chapter" data-level="6" data-path="model-building.html"><a href="model-building.html"><i class="fa fa-check"></i><b>6</b> Model Building</a>
<ul>
<li class="chapter" data-level="6.1" data-path="compartment-models.html"><a href="compartment-models.html"><i class="fa fa-check"></i><b>6.1</b> Compartment Models</a></li>
<li class="chapter" data-level="6.2" data-path="section.html"><a href="section.html"><i class="fa fa-check"></i><b>6.2</b> </a></li>
<li class="chapter" data-level="6.3" data-path="primary-model-development.html"><a href="primary-model-development.html"><i class="fa fa-check"></i><b>6.3</b> Primary Model Development</a></li>
<li class="chapter" data-level="6.4" data-path="implementation-and-verification.html"><a href="implementation-and-verification.html"><i class="fa fa-check"></i><b>6.4</b> Implementation and Verification</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="implementation-and-verification.html"><a href="implementation-and-verification.html#solving"><i class="fa fa-check"></i><b>6.4.1</b> Solving</a></li>
<li class="chapter" data-level="6.4.2" data-path="implementation-and-verification.html"><a href="implementation-and-verification.html#mathematical-analysis"><i class="fa fa-check"></i><b>6.4.2</b> Mathematical Analysis</a></li>
<li class="chapter" data-level="6.4.3" data-path="implementation-and-verification.html"><a href="implementation-and-verification.html#simulation-1"><i class="fa fa-check"></i><b>6.4.3</b> Simulation</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="what-is-a-model-1.html"><a href="what-is-a-model-1.html"><i class="fa fa-check"></i><b>6.5</b> What is a Model?</a></li>
<li class="chapter" data-level="6.6" data-path="accuracy-validation.html"><a href="accuracy-validation.html"><i class="fa fa-check"></i><b>6.6</b> Accuracy &amp; Validation</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="accuracy-validation.html"><a href="accuracy-validation.html#validation-points"><i class="fa fa-check"></i><b>6.6.1</b> Validation Points</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="the-measure-of-a-model.html"><a href="the-measure-of-a-model.html"><i class="fa fa-check"></i><b>6.7</b> The Measure of a Model</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="the-measure-of-a-model.html"><a href="the-measure-of-a-model.html#limitations"><i class="fa fa-check"></i><b>6.7.1</b> Limitations</a></li>
<li class="chapter" data-level="6.7.2" data-path="the-measure-of-a-model.html"><a href="the-measure-of-a-model.html#parsimony"><i class="fa fa-check"></i><b>6.7.2</b> Parsimony</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="secondary-model-development.html"><a href="secondary-model-development.html"><i class="fa fa-check"></i><b>6.8</b> Secondary Model Development</a></li>
<li class="chapter" data-level="6.9" data-path="conclusions.html"><a href="conclusions.html"><i class="fa fa-check"></i><b>6.9</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="adult-mosquito-dynamics.html"><a href="adult-mosquito-dynamics.html"><i class="fa fa-check"></i><b>7</b> Adult Mosquito Dynamics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mosquito-ecology.html"><a href="mosquito-ecology.html"><i class="fa fa-check"></i><b>7.1</b> Mosquito Ecology</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="mosquito-ecology.html"><a href="mosquito-ecology.html#variables-2"><i class="fa fa-check"></i><b>7.1.1</b> Variables</a></li>
<li class="chapter" data-level="7.1.2" data-path="mosquito-ecology.html"><a href="mosquito-ecology.html#blood-fed-mosquitoes"><i class="fa fa-check"></i><b>7.1.2</b> Blood Fed Mosquitoes</a></li>
<li class="chapter" data-level="7.1.3" data-path="mosquito-ecology.html"><a href="mosquito-ecology.html#infected-mosquitoes"><i class="fa fa-check"></i><b>7.1.3</b> Infected Mosquitoes</a></li>
<li class="chapter" data-level="7.1.4" data-path="mosquito-ecology.html"><a href="mosquito-ecology.html#infectious-mosquitoes"><i class="fa fa-check"></i><b>7.1.4</b> Infectious Mosquitoes</a></li>
<li class="chapter" data-level="7.1.5" data-path="mosquito-ecology.html"><a href="mosquito-ecology.html#RossEqn"><i class="fa fa-check"></i><b>7.1.5</b> Infected Humans</a></li>
<li class="chapter" data-level="7.1.6" data-path="mosquito-ecology.html"><a href="mosquito-ecology.html#as-a-system"><i class="fa fa-check"></i><b>7.1.6</b> …as a System</a></li>
<li class="chapter" data-level="7.1.7" data-path="mosquito-ecology.html"><a href="mosquito-ecology.html#solutions"><i class="fa fa-check"></i><b>7.1.7</b> Solutions</a></li>
<li class="chapter" data-level="7.1.8" data-path="mosquito-ecology.html"><a href="mosquito-ecology.html#initial-values"><i class="fa fa-check"></i><b>7.1.8</b> Initial Values</a></li>
<li class="chapter" data-level="7.1.9" data-path="mosquito-ecology.html"><a href="mosquito-ecology.html#parameter-values"><i class="fa fa-check"></i><b>7.1.9</b> Parameter Values</a></li>
<li class="chapter" data-level="7.1.10" data-path="mosquito-ecology.html"><a href="mosquito-ecology.html#solving-1"><i class="fa fa-check"></i><b>7.1.10</b> Solving</a></li>
<li class="chapter" data-level="7.1.11" data-path="mosquito-ecology.html"><a href="mosquito-ecology.html#visualizing"><i class="fa fa-check"></i><b>7.1.11</b> Visualizing</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="steady-states.html"><a href="steady-states.html"><i class="fa fa-check"></i><b>7.2</b> Steady States</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="steady-states.html"><a href="steady-states.html#mosquito-density"><i class="fa fa-check"></i><b>7.2.1</b> Mosquito Density</a></li>
<li class="chapter" data-level="7.2.2" data-path="steady-states.html"><a href="steady-states.html#eir"><i class="fa fa-check"></i><b>7.2.2</b> EIR</a></li>
<li class="chapter" data-level="7.2.3" data-path="steady-states.html"><a href="steady-states.html#vectorial-capacity"><i class="fa fa-check"></i><b>7.2.3</b> Vectorial Capacity</a></li>
<li class="chapter" data-level="7.2.4" data-path="steady-states.html"><a href="steady-states.html#malaria-prevalence-thresholds"><i class="fa fa-check"></i><b>7.2.4</b> Malaria Prevalence &amp; Thresholds</a></li>
<li class="chapter" data-level="7.2.5" data-path="steady-states.html"><a href="steady-states.html#checking-our-work"><i class="fa fa-check"></i><b>7.2.5</b> Checking our Work</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="stable-orbits.html"><a href="stable-orbits.html"><i class="fa fa-check"></i><b>7.3</b> Stable Orbits</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="stable-orbits.html"><a href="stable-orbits.html#thresholds-1"><i class="fa fa-check"></i><b>7.3.1</b> Thresholds</a></li>
<li class="chapter" data-level="7.3.2" data-path="stable-orbits.html"><a href="stable-orbits.html#orbits"><i class="fa fa-check"></i><b>7.3.2</b> Orbits</a></li>
<li class="chapter" data-level="7.3.3" data-path="stable-orbits.html"><a href="stable-orbits.html#average-dynamics"><i class="fa fa-check"></i><b>7.3.3</b> Average Dynamics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="blood-feeding.html"><a href="blood-feeding.html"><i class="fa fa-check"></i><b>8</b> Blood Feeding</a>
<ul>
<li class="chapter" data-level="8.1" data-path="section-1.html"><a href="section-1.html"><i class="fa fa-check"></i><b>8.1</b> </a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mosquito-ecology-1.html"><a href="mosquito-ecology-1.html"><i class="fa fa-check"></i><b>9</b> Mosquito Ecology</a>
<ul>
<li class="chapter" data-level="9.1" data-path="egg-laying.html"><a href="egg-laying.html"><i class="fa fa-check"></i><b>9.1</b> Egg Laying</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="human-age-demography.html"><a href="human-age-demography.html"><i class="fa fa-check"></i><b>10</b> Human Age &amp; Demography</a>
<ul>
<li class="chapter" data-level="10.1" data-path="cohort-dynamics.html"><a href="cohort-dynamics.html"><i class="fa fa-check"></i><b>10.1</b> Cohort Dynamics</a></li>
<li class="chapter" data-level="10.2" data-path="gallerkin.html"><a href="gallerkin.html"><i class="fa fa-check"></i><b>10.2</b> Gallerkin</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="realism-complexity.html"><a href="realism-complexity.html"><i class="fa fa-check"></i><b>11</b> Realism &amp; Complexity</a>
<ul>
<li class="chapter" data-level="11.1" data-path="malaria-epidemiology.html"><a href="malaria-epidemiology.html"><i class="fa fa-check"></i><b>11.1</b> Malaria Epidemiology</a></li>
<li class="chapter" data-level="11.2" data-path="transmission.html"><a href="transmission.html"><i class="fa fa-check"></i><b>11.2</b> Transmission</a></li>
<li class="chapter" data-level="11.3" data-path="mosquito-ecology-2.html"><a href="mosquito-ecology-2.html"><i class="fa fa-check"></i><b>11.3</b> Mosquito Ecology</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="mosquito-ecology-2.html"><a href="mosquito-ecology-2.html#resource-availability"><i class="fa fa-check"></i><b>11.3.1</b> Resource Availability</a></li>
<li class="chapter" data-level="11.3.2" data-path="mosquito-ecology-2.html"><a href="mosquito-ecology-2.html#egg-laying-1"><i class="fa fa-check"></i><b>11.3.2</b> Egg Laying</a></li>
<li class="chapter" data-level="11.3.3" data-path="mosquito-ecology-2.html"><a href="mosquito-ecology-2.html#regulation"><i class="fa fa-check"></i><b>11.3.3</b> Regulation</a></li>
<li class="chapter" data-level="11.3.4" data-path="mosquito-ecology-2.html"><a href="mosquito-ecology-2.html#exogenous-forcing"><i class="fa fa-check"></i><b>11.3.4</b> Exogenous Forcing</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="heterogeneity-stratification.html"><a href="heterogeneity-stratification.html"><i class="fa fa-check"></i><b>11.4</b> Heterogeneity &amp; Stratification</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="heterogeneity-stratification.html"><a href="heterogeneity-stratification.html#strata-in-the-ross-model"><i class="fa fa-check"></i><b>11.4.1</b> Strata in the Ross model</a></li>
<li class="chapter" data-level="11.4.2" data-path="heterogeneity-stratification.html"><a href="heterogeneity-stratification.html#frailties"><i class="fa fa-check"></i><b>11.4.2</b> Frailties</a></li>
<li class="chapter" data-level="11.4.3" data-path="heterogeneity-stratification.html"><a href="heterogeneity-stratification.html#age"><i class="fa fa-check"></i><b>11.4.3</b> Age</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="spatial-dynamics.html"><a href="spatial-dynamics.html"><i class="fa fa-check"></i><b>11.5</b> Spatial Dynamics</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="spatial-dynamics.html"><a href="spatial-dynamics.html#human-migration-mobility-travel"><i class="fa fa-check"></i><b>11.5.1</b> Human Migration, Mobility &amp; Travel</a></li>
<li class="chapter" data-level="11.5.2" data-path="spatial-dynamics.html"><a href="spatial-dynamics.html#mosquito-search-dispersal"><i class="fa fa-check"></i><b>11.5.2</b> Mosquito Search &amp; Dispersal</a></li>
<li class="chapter" data-level="11.5.3" data-path="spatial-dynamics.html"><a href="spatial-dynamics.html#the-mixing-matrix"><i class="fa fa-check"></i><b>11.5.3</b> The Mixing Matrix</a></li>
<li class="chapter" data-level="11.5.4" data-path="spatial-dynamics.html"><a href="spatial-dynamics.html#pathogen-dispersal-by-humans"><i class="fa fa-check"></i><b>11.5.4</b> Pathogen Dispersal by Humans</a></li>
<li class="chapter" data-level="11.5.5" data-path="spatial-dynamics.html"><a href="spatial-dynamics.html#pathogen-dispersal-by-mosquitoes"><i class="fa fa-check"></i><b>11.5.5</b> Pathogen Dispersal by Mosquitoes</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="exogenous-forcing-1.html"><a href="exogenous-forcing-1.html"><i class="fa fa-check"></i><b>11.6</b> Exogenous Forcing</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="exogenous-forcing-1.html"><a href="exogenous-forcing-1.html#weather"><i class="fa fa-check"></i><b>11.6.1</b> Weather</a></li>
<li class="chapter" data-level="11.6.2" data-path="exogenous-forcing-1.html"><a href="exogenous-forcing-1.html#habitat-dynamics"><i class="fa fa-check"></i><b>11.6.2</b> Habitat Dynamics</a></li>
<li class="chapter" data-level="11.6.3" data-path="exogenous-forcing-1.html"><a href="exogenous-forcing-1.html#the-eip"><i class="fa fa-check"></i><b>11.6.3</b> The EIP</a></li>
<li class="chapter" data-level="11.6.4" data-path="exogenous-forcing-1.html"><a href="exogenous-forcing-1.html#seasonality"><i class="fa fa-check"></i><b>11.6.4</b> Seasonality</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="integrated-vector-control.html"><a href="integrated-vector-control.html"><i class="fa fa-check"></i><b>11.7</b> Integrated Vector Control</a></li>
<li class="chapter" data-level="11.8" data-path="integrated-malaria-control.html"><a href="integrated-malaria-control.html"><i class="fa fa-check"></i><b>11.8</b> Integrated Malaria Control</a></li>
<li class="chapter" data-level="11.9" data-path="context.html"><a href="context.html"><i class="fa fa-check"></i><b>11.9</b> Context</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="modularity-and-software.html"><a href="modularity-and-software.html"><i class="fa fa-check"></i><b>12</b> Modularity and Software</a>
<ul>
<li class="chapter" data-level="12.1" data-path="model-building-1.html"><a href="model-building-1.html"><i class="fa fa-check"></i><b>12.1</b> Model Building</a></li>
<li class="chapter" data-level="12.2" data-path="modular-computation.html"><a href="modular-computation.html"><i class="fa fa-check"></i><b>12.2</b> Modular Computation</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="modular-computation.html"><a href="modular-computation.html#exde"><i class="fa fa-check"></i><b>12.2.1</b> <code>exDE</code></a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Epidemiology</b></span></li>
<li class="chapter" data-level="13" data-path="malaria-epidemiology-1.html"><a href="malaria-epidemiology-1.html"><i class="fa fa-check"></i><b>13</b> Malaria Epidemiology</a>
<ul>
<li class="chapter" data-level="13.1" data-path="parasite.html"><a href="parasite.html"><i class="fa fa-check"></i><b>13.1</b> Parasite</a></li>
<li class="chapter" data-level="13.2" data-path="epidemiology.html"><a href="epidemiology.html"><i class="fa fa-check"></i><b>13.2</b> Epidemiology</a></li>
<li class="chapter" data-level="13.3" data-path="infection-1.html"><a href="infection-1.html"><i class="fa fa-check"></i><b>13.3</b> Infection</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="infection-1.html"><a href="infection-1.html#superinfection-1"><i class="fa fa-check"></i><b>13.3.1</b> Superinfection</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="disease-immunity.html"><a href="disease-immunity.html"><i class="fa fa-check"></i><b>13.4</b> Disease &amp; Immunity</a></li>
<li class="chapter" data-level="13.5" data-path="gametocytes-and-infectiousness.html"><a href="gametocytes-and-infectiousness.html"><i class="fa fa-check"></i><b>13.5</b> Gametocytes and Infectiousness</a></li>
<li class="chapter" data-level="13.6" data-path="treatment-and-chemoprotection.html"><a href="treatment-and-chemoprotection.html"><i class="fa fa-check"></i><b>13.6</b> Treatment and Chemoprotection</a>
<ul>
<li class="chapter" data-level="13.6.1" data-path="treatment-and-chemoprotection.html"><a href="treatment-and-chemoprotection.html#the-time-course-of-an-infection"><i class="fa fa-check"></i><b>13.6.1</b> The Time Course of an Infection</a></li>
<li class="chapter" data-level="13.6.2" data-path="treatment-and-chemoprotection.html"><a href="treatment-and-chemoprotection.html#intrahost-models"><i class="fa fa-check"></i><b>13.6.2</b> Intrahost Models</a></li>
<li class="chapter" data-level="13.6.3" data-path="treatment-and-chemoprotection.html"><a href="treatment-and-chemoprotection.html#synthesis"><i class="fa fa-check"></i><b>13.6.3</b> Synthesis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="infection-2.html"><a href="infection-2.html"><i class="fa fa-check"></i><b>14</b> Infection</a>
<ul>
<li class="chapter" data-level="14.1" data-path="life-stages.html"><a href="life-stages.html"><i class="fa fa-check"></i><b>14.1</b> Life Stages</a>
<ul>
<li class="chapter" data-level="14.1.1" data-path="life-stages.html"><a href="life-stages.html#sporozoites"><i class="fa fa-check"></i><b>14.1.1</b> Sporozoites</a></li>
<li class="chapter" data-level="14.1.2" data-path="life-stages.html"><a href="life-stages.html#liver-stages"><i class="fa fa-check"></i><b>14.1.2</b> Liver Stages</a></li>
<li class="chapter" data-level="14.1.3" data-path="life-stages.html"><a href="life-stages.html#asexual-stages"><i class="fa fa-check"></i><b>14.1.3</b> Asexual Stages</a></li>
<li class="chapter" data-level="14.1.4" data-path="life-stages.html"><a href="life-stages.html#gametocytes"><i class="fa fa-check"></i><b>14.1.4</b> Gametocytes</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="controlled-infections.html"><a href="controlled-infections.html"><i class="fa fa-check"></i><b>14.2</b> Controlled Infections</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="controlled-infections.html"><a href="controlled-infections.html#malariotherapy"><i class="fa fa-check"></i><b>14.2.1</b> Malariotherapy</a></li>
<li class="chapter" data-level="14.2.2" data-path="controlled-infections.html"><a href="controlled-infections.html#chmi"><i class="fa fa-check"></i><b>14.2.2</b> CHMI</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="a-simple-infection.html"><a href="a-simple-infection.html"><i class="fa fa-check"></i><b>14.3</b> A Simple Infection</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="a-simple-infection.html"><a href="a-simple-infection.html#time-course"><i class="fa fa-check"></i><b>14.3.1</b> Time Course</a></li>
<li class="chapter" data-level="14.3.2" data-path="a-simple-infection.html"><a href="a-simple-infection.html#duration"><i class="fa fa-check"></i><b>14.3.2</b> Duration</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="superinfection-2.html"><a href="superinfection-2.html"><i class="fa fa-check"></i><b>14.4</b> Superinfection</a></li>
<li class="chapter" data-level="14.5" data-path="process-vs.-observation.html"><a href="process-vs.-observation.html"><i class="fa fa-check"></i><b>14.5</b> Process <em>vs.</em> Observation</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="process-vs.-observation.html"><a href="process-vs.-observation.html#detection"><i class="fa fa-check"></i><b>14.5.1</b> Detection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="superinfection-3.html"><a href="superinfection-3.html"><i class="fa fa-check"></i><b>15</b> Superinfection</a>
<ul>
<li class="chapter" data-level="15.1" data-path="parasite-densities-and-detection.html"><a href="parasite-densities-and-detection.html"><i class="fa fa-check"></i><b>15.1</b> Parasite Densities and Detection</a></li>
<li class="chapter" data-level="15.2" data-path="light-microscopy.html"><a href="light-microscopy.html"><i class="fa fa-check"></i><b>15.2</b> Light Microscopy</a></li>
<li class="chapter" data-level="15.3" data-path="biomarkers-and-rdts.html"><a href="biomarkers-and-rdts.html"><i class="fa fa-check"></i><b>15.3</b> Biomarkers and RDTs</a></li>
<li class="chapter" data-level="15.4" data-path="pcr.html"><a href="pcr.html"><i class="fa fa-check"></i><b>15.4</b> PCR</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="age-exposure-and-malaria-immunity.html"><a href="age-exposure-and-malaria-immunity.html"><i class="fa fa-check"></i><b>16</b> Age, Exposure and Malaria Immunity</a>
<ul>
<li class="chapter" data-level="16.1" data-path="the-garki-model.html"><a href="the-garki-model.html"><i class="fa fa-check"></i><b>16.1</b> The Garki Model</a></li>
<li class="chapter" data-level="16.2" data-path="stage-structured-immunity.html"><a href="stage-structured-immunity.html"><i class="fa fa-check"></i><b>16.2</b> Stage-Structured Immunity</a></li>
<li class="chapter" data-level="16.3" data-path="strain-specific-immunity.html"><a href="strain-specific-immunity.html"><i class="fa fa-check"></i><b>16.3</b> Strain Specific Immunity</a></li>
<li class="chapter" data-level="16.4" data-path="memory-tracking.html"><a href="memory-tracking.html"><i class="fa fa-check"></i><b>16.4</b> Memory Tracking</a></li>
<li class="chapter" data-level="16.5" data-path="age-vs.-prevalence.html"><a href="age-vs.-prevalence.html"><i class="fa fa-check"></i><b>16.5</b> Age <em>vs.</em> Prevalence</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="fever-and-severe-disease.html"><a href="fever-and-severe-disease.html"><i class="fa fa-check"></i><b>17</b> Fever and Severe Disease</a>
<ul>
<li class="chapter" data-level="17.1" data-path="fever.html"><a href="fever.html"><i class="fa fa-check"></i><b>17.1</b> Fever</a></li>
<li class="chapter" data-level="17.2" data-path="anemia.html"><a href="anemia.html"><i class="fa fa-check"></i><b>17.2</b> Anemia</a></li>
<li class="chapter" data-level="17.3" data-path="severe-disease.html"><a href="severe-disease.html"><i class="fa fa-check"></i><b>17.3</b> Severe Disease</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="drug-taking.html"><a href="drug-taking.html"><i class="fa fa-check"></i><b>18</b> Drug Taking</a>
<ul>
<li class="chapter" data-level="18.1" data-path="curing-infections.html"><a href="curing-infections.html"><i class="fa fa-check"></i><b>18.1</b> Curing Infections</a></li>
<li class="chapter" data-level="18.2" data-path="chemoprotection.html"><a href="chemoprotection.html"><i class="fa fa-check"></i><b>18.2</b> Chemoprotection</a></li>
<li class="chapter" data-level="18.3" data-path="adherance.html"><a href="adherance.html"><i class="fa fa-check"></i><b>18.3</b> Adherance</a></li>
<li class="chapter" data-level="18.4" data-path="treatment-rates.html"><a href="treatment-rates.html"><i class="fa fa-check"></i><b>18.4</b> Treatment Rates</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="gametocytes-and-infectiousness-1.html"><a href="gametocytes-and-infectiousness-1.html"><i class="fa fa-check"></i><b>19</b> Gametocytes and Infectiousness</a>
<ul>
<li class="chapter" data-level="19.1" data-path="gametocytemia.html"><a href="gametocytemia.html"><i class="fa fa-check"></i><b>19.1</b> Gametocytemia</a></li>
<li class="chapter" data-level="19.2" data-path="anti-gametocyte-immunity.html"><a href="anti-gametocyte-immunity.html"><i class="fa fa-check"></i><b>19.2</b> Anti-Gametocyte Immunity</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="care-seeking.html"><a href="care-seeking.html"><i class="fa fa-check"></i><b>20</b> Care Seeking</a></li>
<li class="chapter" data-level="21" data-path="modeling-malaria-epidemiology.html"><a href="modeling-malaria-epidemiology.html"><i class="fa fa-check"></i><b>21</b> Modeling Malaria Epidemiology</a>
<ul>
<li class="chapter" data-level="21.1" data-path="section-2.html"><a href="section-2.html"><i class="fa fa-check"></i><b>21.1</b> </a></li>
</ul></li>
<li class="part"><span><b>IV Transmission</b></span></li>
<li class="chapter" data-level="22" data-path="blood-feeding-1.html"><a href="blood-feeding-1.html"><i class="fa fa-check"></i><b>22</b> Blood Feeding</a>
<ul>
<li class="chapter" data-level="22.0.1" data-path="blood-feeding-1.html"><a href="blood-feeding-1.html#search-and-risk"><i class="fa fa-check"></i><b>22.0.1</b> Search and Risk</a></li>
<li class="chapter" data-level="22.0.2" data-path="blood-feeding-1.html"><a href="blood-feeding-1.html#search-weights-and-availability"><i class="fa fa-check"></i><b>22.0.2</b> Search Weights and Availability</a></li>
<li class="chapter" data-level="22.0.3" data-path="blood-feeding-1.html"><a href="blood-feeding-1.html#functional-response"><i class="fa fa-check"></i><b>22.0.3</b> Functional Response</a></li>
<li class="chapter" data-level="22.0.4" data-path="blood-feeding-1.html"><a href="blood-feeding-1.html#environmental-heterogeneity"><i class="fa fa-check"></i><b>22.0.4</b> Environmental Heterogeneity</a></li>
<li class="chapter" data-level="22.1" data-path="host-availability.html"><a href="host-availability.html"><i class="fa fa-check"></i><b>22.1</b> Host Availability</a></li>
<li class="chapter" data-level="22.2" data-path="blood-feeding-rates.html"><a href="blood-feeding-rates.html"><i class="fa fa-check"></i><b>22.2</b> Blood Feeding Rates</a></li>
<li class="chapter" data-level="22.3" data-path="the-human-fraction.html"><a href="the-human-fraction.html"><i class="fa fa-check"></i><b>22.3</b> The Human Fraction</a></li>
<li class="chapter" data-level="22.4" data-path="the-mixing-matrix-beta.html"><a href="the-mixing-matrix-beta.html"><i class="fa fa-check"></i><b>22.4</b> The Mixing Matrix, <span class="math inline">\(\beta\)</span></a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="human-mobility.html"><a href="human-mobility.html"><i class="fa fa-check"></i><b>23</b> Human Mobility</a>
<ul>
<li class="chapter" data-level="23.1" data-path="modalities.html"><a href="modalities.html"><i class="fa fa-check"></i><b>23.1</b> Modalities</a></li>
<li class="chapter" data-level="23.2" data-path="time-at-risk.html"><a href="time-at-risk.html"><i class="fa fa-check"></i><b>23.2</b> Time at Risk</a></li>
<li class="chapter" data-level="23.3" data-path="travel.html"><a href="travel.html"><i class="fa fa-check"></i><b>23.3</b> Travel</a></li>
<li class="chapter" data-level="23.4" data-path="migration.html"><a href="migration.html"><i class="fa fa-check"></i><b>23.4</b> Migration</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="spatial-dynamics-1.html"><a href="spatial-dynamics-1.html"><i class="fa fa-check"></i><b>24</b> Spatial Dynamics</a></li>
<li class="chapter" data-level="25" data-path="heterogeneous-transmission.html"><a href="heterogeneous-transmission.html"><i class="fa fa-check"></i><b>25</b> Heterogeneous Transmission</a>
<ul>
<li class="chapter" data-level="25.1" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>25.1</b> Overview</a>
<ul>
<li class="chapter" data-level="25.1.1" data-path="overview.html"><a href="overview.html#age-1"><i class="fa fa-check"></i><b>25.1.1</b> Age</a></li>
<li class="chapter" data-level="25.1.2" data-path="overview.html"><a href="overview.html#location"><i class="fa fa-check"></i><b>25.1.2</b> Location</a></li>
<li class="chapter" data-level="25.1.3" data-path="overview.html"><a href="overview.html#house-type"><i class="fa fa-check"></i><b>25.1.3</b> House Type</a></li>
<li class="chapter" data-level="25.1.4" data-path="overview.html"><a href="overview.html#activities"><i class="fa fa-check"></i><b>25.1.4</b> Activities</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="frailtyCh.html"><a href="frailtyCh.html"><i class="fa fa-check"></i><b>25.2</b> Frailty</a></li>
<li class="chapter" data-level="25.3" data-path="environmentalHeterogeneity.html"><a href="environmentalHeterogeneity.html"><i class="fa fa-check"></i><b>25.3</b> Environmental Heterogeneity</a></li>
</ul></li>
<li class="part"><span><b>V Mosquito Ecology</b></span></li>
<li class="chapter" data-level="26" data-path="mosquitoes.html"><a href="mosquitoes.html"><i class="fa fa-check"></i><b>26</b> Mosquitoes</a>
<ul>
<li class="chapter" data-level="26.1" data-path="aquatic-dynamics.html"><a href="aquatic-dynamics.html"><i class="fa fa-check"></i><b>26.1</b> Aquatic Dynamics</a>
<ul>
<li class="chapter" data-level="26.1.1" data-path="aquatic-dynamics.html"><a href="aquatic-dynamics.html#equations-3"><i class="fa fa-check"></i><b>26.1.1</b> Equations</a></li>
<li class="chapter" data-level="26.1.2" data-path="aquatic-dynamics.html"><a href="aquatic-dynamics.html#solutions-1"><i class="fa fa-check"></i><b>26.1.2</b> Solutions</a></li>
<li class="chapter" data-level="26.1.3" data-path="aquatic-dynamics.html"><a href="aquatic-dynamics.html#regulation-1"><i class="fa fa-check"></i><b>26.1.3</b> Regulation</a></li>
</ul></li>
<li class="chapter" data-level="26.2" data-path="understanding-mosquito-dynamics.html"><a href="understanding-mosquito-dynamics.html"><i class="fa fa-check"></i><b>26.2</b> Understanding Mosquito Dynamics</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="behavioral-state-models.html"><a href="behavioral-state-models.html"><i class="fa fa-check"></i><b>27</b> Behavioral State Models</a></li>
<li class="chapter" data-level="28" data-path="mosquito-dispersal.html"><a href="mosquito-dispersal.html"><i class="fa fa-check"></i><b>28</b> Mosquito Dispersal</a></li>
<li class="chapter" data-level="29" data-path="aquatic-ecology.html"><a href="aquatic-ecology.html"><i class="fa fa-check"></i><b>29</b> Aquatic Ecology</a></li>
<li class="chapter" data-level="30" data-path="temporal-dynamics.html"><a href="temporal-dynamics.html"><i class="fa fa-check"></i><b>30</b> Temporal Dynamics</a>
<ul>
<li class="chapter" data-level="30.1" data-path="exogenous-forcing-2.html"><a href="exogenous-forcing-2.html"><i class="fa fa-check"></i><b>30.1</b> Exogenous Forcing</a></li>
<li class="chapter" data-level="30.2" data-path="mosquito-survival-through-the-eip.html"><a href="mosquito-survival-through-the-eip.html"><i class="fa fa-check"></i><b>30.2</b> Mosquito Survival through the EIP</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="multi-species-models.html"><a href="multi-species-models.html"><i class="fa fa-check"></i><b>31</b> Multi-Species Models</a>
<ul>
<li class="chapter" data-level="31.1" data-path="vector-competence.html"><a href="vector-competence.html"><i class="fa fa-check"></i><b>31.1</b> Vector Competence</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="measuring-mosquitoes.html"><a href="measuring-mosquitoes.html"><i class="fa fa-check"></i><b>32</b> Measuring Mosquitoes</a></li>
<li class="part"><span><b>VI Malaria Control</b></span></li>
<li class="chapter" data-level="33" data-path="malaria-control-1.html"><a href="malaria-control-1.html"><i class="fa fa-check"></i><b>33</b> Malaria Control</a>
<ul>
<li class="chapter" data-level="33.1" data-path="health-systems.html"><a href="health-systems.html"><i class="fa fa-check"></i><b>33.1</b> Health Systems</a></li>
<li class="chapter" data-level="33.2" data-path="vector-control.html"><a href="vector-control.html"><i class="fa fa-check"></i><b>33.2</b> Vector Control</a></li>
</ul></li>
<li class="chapter" data-level="34" data-path="insecticide-treated-bednets.html"><a href="insecticide-treated-bednets.html"><i class="fa fa-check"></i><b>34</b> Insecticide-Treated Bednets</a></li>
<li class="chapter" data-level="35" data-path="indoor-residual-spraying.html"><a href="indoor-residual-spraying.html"><i class="fa fa-check"></i><b>35</b> Indoor Residual Spraying</a></li>
<li class="chapter" data-level="36" data-path="larval-source-management-1.html"><a href="larval-source-management-1.html"><i class="fa fa-check"></i><b>36</b> Larval Source Management</a></li>
<li class="chapter" data-level="37" data-path="attractive-toxic-sugar-baits.html"><a href="attractive-toxic-sugar-baits.html"><i class="fa fa-check"></i><b>37</b> Attractive Toxic Sugar Baits</a></li>
<li class="chapter" data-level="38" data-path="integrated-vector-control-1.html"><a href="integrated-vector-control-1.html"><i class="fa fa-check"></i><b>38</b> Integrated Vector Control</a></li>
<li class="part"><span><b>VII Health Systems</b></span></li>
<li class="chapter" data-level="39" data-path="cohort-dynamics-1.html"><a href="cohort-dynamics-1.html"><i class="fa fa-check"></i><b>39</b> Cohort Dynamics</a>
<ul>
<li class="chapter" data-level="39.1" data-path="boxcar-models.html"><a href="boxcar-models.html"><i class="fa fa-check"></i><b>39.1</b> Boxcar Models</a></li>
<li class="chapter" data-level="39.2" data-path="delay.html"><a href="delay.html"><i class="fa fa-check"></i><b>39.2</b> Delay</a></li>
</ul></li>
<li class="chapter" data-level="40" data-path="demography.html"><a href="demography.html"><i class="fa fa-check"></i><b>40</b> Demography</a>
<ul>
<li class="chapter" data-level="40.1" data-path="migration-1.html"><a href="migration-1.html"><i class="fa fa-check"></i><b>40.1</b> Migration</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="human-travel-and-malaria-importation.html"><a href="human-travel-and-malaria-importation.html"><i class="fa fa-check"></i><b>41</b> Human Travel and Malaria Importation</a></li>
<li class="chapter" data-level="42" data-path="stratification.html"><a href="stratification.html"><i class="fa fa-check"></i><b>42</b> Stratification</a></li>
<li class="chapter" data-level="43" data-path="pharmaceutical-interventions.html"><a href="pharmaceutical-interventions.html"><i class="fa fa-check"></i><b>43</b> Pharmaceutical Interventions</a>
<ul>
<li class="chapter" data-level="43.1" data-path="smc.html"><a href="smc.html"><i class="fa fa-check"></i><b>43.1</b> SMC</a></li>
<li class="chapter" data-level="43.2" data-path="mda.html"><a href="mda.html"><i class="fa fa-check"></i><b>43.2</b> MDA</a></li>
<li class="chapter" data-level="43.3" data-path="drugs.html"><a href="drugs.html"><i class="fa fa-check"></i><b>43.3</b> Drugs</a></li>
<li class="chapter" data-level="43.4" data-path="vaccines.html"><a href="vaccines.html"><i class="fa fa-check"></i><b>43.4</b> Vaccines</a></li>
</ul></li>
<li class="part"><span><b>VIII Analytics</b></span></li>
<li class="chapter" data-level="44" data-path="malaria-analytics.html"><a href="malaria-analytics.html"><i class="fa fa-check"></i><b>44</b> Malaria Analytics</a></li>
<li class="chapter" data-level="45" data-path="malaria-metrics.html"><a href="malaria-metrics.html"><i class="fa fa-check"></i><b>45</b> Malaria Metrics</a>
<ul>
<li class="chapter" data-level="45.1" data-path="realistic-bounds.html"><a href="realistic-bounds.html"><i class="fa fa-check"></i><b>45.1</b> Realistic Bounds</a></li>
<li class="chapter" data-level="45.2" data-path="the-local-fraction.html"><a href="the-local-fraction.html"><i class="fa fa-check"></i><b>45.2</b> The Local Fraction</a>
<ul>
<li class="chapter" data-level="45.2.1" data-path="the-local-fraction.html"><a href="the-local-fraction.html#travel-1"><i class="fa fa-check"></i><b>45.2.1</b> Travel</a></li>
<li class="chapter" data-level="45.2.2" data-path="the-local-fraction.html"><a href="the-local-fraction.html#mobility"><i class="fa fa-check"></i><b>45.2.2</b> Mobility</a></li>
</ul></li>
<li class="chapter" data-level="45.3" data-path="drug-taking-1.html"><a href="drug-taking-1.html"><i class="fa fa-check"></i><b>45.3</b> Drug Taking</a></li>
<li class="chapter" data-level="45.4" data-path="seasonality-1.html"><a href="seasonality-1.html"><i class="fa fa-check"></i><b>45.4</b> Seasonality</a></li>
<li class="chapter" data-level="45.5" data-path="frailty.html"><a href="frailty.html"><i class="fa fa-check"></i><b>45.5</b> Frailty</a></li>
<li class="chapter" data-level="45.6" data-path="environmental-heterogeneity-1.html"><a href="environmental-heterogeneity-1.html"><i class="fa fa-check"></i><b>45.6</b> Environmental Heterogeneity</a></li>
<li class="chapter" data-level="45.7" data-path="pfeir-vs.-pfpr-in-data.html"><a href="pfeir-vs.-pfpr-in-data.html"><i class="fa fa-check"></i><b>45.7</b> <em>Pf</em>EIR <em>vs.</em> <em>Pf</em>PR in Data</a></li>
<li class="chapter" data-level="45.8" data-path="pfeir-vs.-pffoi-in-data.html"><a href="pfeir-vs.-pffoi-in-data.html"><i class="fa fa-check"></i><b>45.8</b> <em>Pf</em>EIR <em>vs.</em> <em>Pf</em>FoI in Data</a></li>
<li class="chapter" data-level="45.9" data-path="synthesis-1.html"><a href="synthesis-1.html"><i class="fa fa-check"></i><b>45.9</b> Synthesis</a></li>
</ul></li>
<li class="chapter" data-level="46" data-path="discrete-time.html"><a href="discrete-time.html"><i class="fa fa-check"></i><b>46</b> Discrete Time</a></li>
<li class="chapter" data-level="47" data-path="spatial-concepts-and-connectivity.html"><a href="spatial-concepts-and-connectivity.html"><i class="fa fa-check"></i><b>47</b> Spatial Concepts and Connectivity</a></li>
<li class="chapter" data-level="48" data-path="mosquito-microecology.html"><a href="mosquito-microecology.html"><i class="fa fa-check"></i><b>48</b> Mosquito Microecology</a></li>
<li class="chapter" data-level="49" data-path="microsimulation.html"><a href="microsimulation.html"><i class="fa fa-check"></i><b>49</b> Microsimulation</a></li>
<li class="chapter" data-level="50" data-path="spatial-control.html"><a href="spatial-control.html"><i class="fa fa-check"></i><b>50</b> Spatial Control</a></li>
<li class="chapter" data-level="51" data-path="model-libraries.html"><a href="model-libraries.html"><i class="fa fa-check"></i><b>51</b> Model Libraries</a></li>
<li class="chapter" data-level="52" data-path="base-models.html"><a href="base-models.html"><i class="fa fa-check"></i><b>52</b> Base Models</a></li>
<li class="chapter" data-level="53" data-path="built-in-analytics.html"><a href="built-in-analytics.html"><i class="fa fa-check"></i><b>53</b> Built-in Analytics</a></li>
<li class="chapter" data-level="54" data-path="stochasticity.html"><a href="stochasticity.html"><i class="fa fa-check"></i><b>54</b> Stochasticity</a></li>
<li class="part"><span><b>IX Supplements</b></span></li>
<li class="chapter" data-level="55" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>55</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Dynamics for Robust Analytics and Adaptive Malaria Control</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="discrete-time-deterministic" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Discrete Time, Deterministic<a href="discrete-time-deterministic.html#discrete-time-deterministic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can translate Ross’s basic description of a process into a model, but first, we need to start using mathematical symbols and notation to represent the process. The model itself is formulated as a set of coupled difference equations, but we will write down the equations last. To get there, we must learn about the parts of a model: variables, initial conditions, and parameters.</p>
<p>In the following, we also want to write R code to implement and solve the model. We will be adopting some conventions that end up being very useful. So really, this is a lesson about two things.</p>
<div id="variables" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Variables<a href="discrete-time-deterministic.html#variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Variables are quantities that we compute and that change over time. In this model, the variables we compute are the fraction of humans and mosquitoes that are infected at each point in time. Since it is a discrete time system, the values of the variables are defined only at integer values of <span class="math inline">\(t.\)</span></p>
<ul>
<li><p>Let <span class="math inline">\(x_t\)</span> be the fraction of people who are infected at time <span class="math inline">\(t,\)</span> and <span class="math inline">\(0 \leq x_t \leq 1.\)</span></p></li>
<li><p>Let <span class="math inline">\(y_t\)</span> be the fraction of mosquitoes who are infected at time <span class="math inline">\(t,\)</span> <span class="math inline">\(0 \leq y_t \leq 1.\)</span></p></li>
</ul>
</div>
<div id="initial-conditions" class="section level3 hasAnchor" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Initial Conditions<a href="discrete-time-deterministic.html#initial-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since the values of our variables in the next time step (at time <span class="math inline">\(t+1\)</span>) depend on their values now (at time <span class="math inline">\(t\)</span>), we can’t really compute anything unless we can say how the process gets started. What are the values of our variables at the beginning of our simulations (usually, at time <span class="math inline">\(t=0\)</span>)?</p>
<p>We set these initial values to be small:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="discrete-time-deterministic.html#cb1-1" tabindex="-1"></a><span class="co"># Initial Conditions, as a Named Vector</span></span>
<span id="cb1-2"><a href="discrete-time-deterministic.html#cb1-2" tabindex="-1"></a>x0 <span class="ot">=</span> .<span class="dv">01</span></span>
<span id="cb1-3"><a href="discrete-time-deterministic.html#cb1-3" tabindex="-1"></a>y0 <span class="ot">=</span> .<span class="dv">001</span></span>
<span id="cb1-4"><a href="discrete-time-deterministic.html#cb1-4" tabindex="-1"></a>xy <span class="ot">=</span> <span class="fu">c</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">x=</span>x0, <span class="at">y=</span>y0)</span></code></pre></div>
</div>
<div id="parameters" class="section level3 hasAnchor" number="2.1.3">
<h3><span class="header-section-number">2.1.3</span> Parameters<a href="discrete-time-deterministic.html#parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The parameters describe the processes that are occurring in the population, the fraction of humans that clear an infection each day, and the fraction of infected mosquitoes that die. Unlike variables, parameters are passed to the model.</p>
<ul>
<li><p>Let <span class="math inline">\(s\)</span> denote the fraction of people who clear infections after one day; <span class="math inline">\(0 &lt; s &lt; 1.\)</span></p></li>
<li><p>Let <span class="math inline">\(u\)</span> denote the fraction of mosquitoes who die in one day; <span class="math inline">\(0 &lt; u &lt; 1.\)</span></p></li>
<li><p>Let <span class="math inline">\(a\)</span> denote the fraction of mosquitoes who blood feed on a human in a day; <span class="math inline">\(0 &lt; a &lt; 1.\)</span></p></li>
<li><p>Let <span class="math inline">\(m\)</span> denote the number of mosquitoes per human; <span class="math inline">\(m \geq 0.\)</span></p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="discrete-time-deterministic.html#cb2-1" tabindex="-1"></a><span class="co"># The Parameters, as a Named Vector</span></span>
<span id="cb2-2"><a href="discrete-time-deterministic.html#cb2-2" tabindex="-1"></a>par <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb2-3"><a href="discrete-time-deterministic.html#cb2-3" tabindex="-1"></a>  <span class="at">s =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">200</span>, <span class="co"># The fraction of infections that clear each day</span></span>
<span id="cb2-4"><a href="discrete-time-deterministic.html#cb2-4" tabindex="-1"></a>  <span class="at">u =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">12</span>,  <span class="co"># The fraction of mosquitoes that die each day</span></span>
<span id="cb2-5"><a href="discrete-time-deterministic.html#cb2-5" tabindex="-1"></a>  <span class="at">a =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>,   <span class="co"># The fraction of mosquitoes that blood feed on a human each day</span></span>
<span id="cb2-6"><a href="discrete-time-deterministic.html#cb2-6" tabindex="-1"></a>  <span class="at">m =</span> <span class="dv">2</span>      <span class="co"># The number of mosquitoes per human</span></span>
<span id="cb2-7"><a href="discrete-time-deterministic.html#cb2-7" tabindex="-1"></a>) </span></code></pre></div>
</div>
<div id="equations" class="section level3 hasAnchor" number="2.1.4">
<h3><span class="header-section-number">2.1.4</span> Equations<a href="discrete-time-deterministic.html#equations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, we put all this together into a mathematical statement that has translated the description of a process. There are four terms:</p>
<ul>
<li><p>The fraction of humans who are infected is <span class="math inline">\(x_t\)</span>; a fraction <span class="math inline">\(s\)</span> clear infections.</p></li>
<li><p>The fraction of mosquitoes who are infected is <span class="math inline">\(y_t\)</span>; a fraction <span class="math inline">\(u\)</span> die.</p></li>
<li><p>The fraction of humans who are infected is <span class="math inline">\(1-x_t\)</span>; a fraction <span class="math inline">\(m a y_t\)</span> will become infected.</p></li>
<li><p>The fraction of mosquitoes who are not infected is <span class="math inline">\(1-y_t\)</span>; a fraction <span class="math inline">\(a x_t\)</span> become infected.</p></li>
</ul>
<p><span class="math display">\[\begin{array}{rl}
x_{t+1} &amp;=  x_t - s x_t + m a y_t (1-x_t)  \\
y_{t+1} &amp;=  y_t - u y_t + a x_t (1 - y_t) \\
\end{array}\]</span></p>
<p>We write a function that computes and returns the updated values of the variables. We adopt a simple naming convention: since this is a discrete time system, we will call the function <code>dts_xy_1.</code> It accepts the variables, which describe the state of the system at the current time (as a named vector) and the parameter values (as a list) and it returns the state of the system (as a named vector):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="discrete-time-deterministic.html#cb3-1" tabindex="-1"></a>dts_xy_1 <span class="ot">=</span> <span class="cf">function</span>(xy, p){<span class="fu">with</span>(<span class="fu">as.list</span>(xy), <span class="fu">with</span>(p,{</span>
<span id="cb3-2"><a href="discrete-time-deterministic.html#cb3-2" tabindex="-1"></a>  xn <span class="ot">=</span> x <span class="sc">+</span> m<span class="sc">*</span>a<span class="sc">*</span>y<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">-</span> s<span class="sc">*</span>x</span>
<span id="cb3-3"><a href="discrete-time-deterministic.html#cb3-3" tabindex="-1"></a>  yn <span class="ot">=</span> y <span class="sc">+</span> a<span class="sc">*</span>x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y) <span class="sc">-</span> u<span class="sc">*</span>y</span>
<span id="cb3-4"><a href="discrete-time-deterministic.html#cb3-4" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">t=</span>t<span class="sc">+</span><span class="dv">1</span>, <span class="at">x=</span>xn, <span class="at">y=</span>yn))</span>
<span id="cb3-5"><a href="discrete-time-deterministic.html#cb3-5" tabindex="-1"></a>}))}</span></code></pre></div>
</div>
<div id="simulation" class="section level3 hasAnchor" number="2.1.5">
<h3><span class="header-section-number">2.1.5</span> Simulation<a href="discrete-time-deterministic.html#simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With the R code we developed, we can now compute the values of the variables after one time step. We initialize <code>xy</code> to hold the computed variables over time.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="discrete-time-deterministic.html#cb4-1" tabindex="-1"></a><span class="co"># xy_t stores the values of the variables</span></span>
<span id="cb4-2"><a href="discrete-time-deterministic.html#cb4-2" tabindex="-1"></a>xy_t <span class="ot">=</span> xy </span></code></pre></div>
<p>We name the variables so that later we can call them by name.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="discrete-time-deterministic.html#cb5-1" tabindex="-1"></a><span class="co"># Compute and store the values of the variables  </span></span>
<span id="cb5-2"><a href="discrete-time-deterministic.html#cb5-2" tabindex="-1"></a>xy <span class="ot">=</span> <span class="fu">dts_xy_1</span>(xy, par)</span>
<span id="cb5-3"><a href="discrete-time-deterministic.html#cb5-3" tabindex="-1"></a>xy_t <span class="ot">=</span> <span class="fu">rbind</span>(xy_t, xy)</span></code></pre></div>
<p>We can take a peak at the values we computed:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="discrete-time-deterministic.html#cb6-1" tabindex="-1"></a><span class="co"># Print </span></span>
<span id="cb6-2"><a href="discrete-time-deterministic.html#cb6-2" tabindex="-1"></a><span class="fu">print</span>(xy) </span></code></pre></div>
<pre><code>##           t           x           y 
## 1.000000000 0.010445000 0.003414167</code></pre>
<p>We can iterate over many time steps, storing the values in columns:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="discrete-time-deterministic.html#cb8-1" tabindex="-1"></a><span class="co"># Iterate to compute the values as they change over time </span></span>
<span id="cb8-2"><a href="discrete-time-deterministic.html#cb8-2" tabindex="-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">40</span>){</span>
<span id="cb8-3"><a href="discrete-time-deterministic.html#cb8-3" tabindex="-1"></a>  xy <span class="ot">=</span> <span class="fu">dts_xy_1</span>(xy, par) </span>
<span id="cb8-4"><a href="discrete-time-deterministic.html#cb8-4" tabindex="-1"></a>  xy_t <span class="ot">=</span> <span class="fu">rbind</span>(xy_t, xy) </span>
<span id="cb8-5"><a href="discrete-time-deterministic.html#cb8-5" tabindex="-1"></a>} </span></code></pre></div>
<p>The way we implemented this, the values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are stored in columns:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="discrete-time-deterministic.html#cb9-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">tail</span>(xy_t, <span class="dv">3</span>)) </span></code></pre></div>
<pre><code>##     t         x         y
## xy 38 0.9865573 0.7465869
## xy 39 0.9866426 0.7468730
## xy 40 0.9866975 0.7470700</code></pre>
<p>We can now plot out the values over the first 40 days</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="discrete-time-deterministic.html#cb11-1" tabindex="-1"></a><span class="fu">with</span>(<span class="fu">data.frame</span>(xy_t),{</span>
<span id="cb11-2"><a href="discrete-time-deterministic.html#cb11-2" tabindex="-1"></a>  <span class="fu">plot</span>(t, x, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;x, y&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">pch=</span><span class="dv">15</span>)</span>
<span id="cb11-3"><a href="discrete-time-deterministic.html#cb11-3" tabindex="-1"></a>  <span class="fu">lines</span>(t, y, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">pch =</span><span class="dv">19</span>)</span>
<span id="cb11-4"><a href="discrete-time-deterministic.html#cb11-4" tabindex="-1"></a>})</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>After 40 days, the values of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are not changing very much:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="discrete-time-deterministic.html#cb12-1" tabindex="-1"></a><span class="co"># The last value is still stored as xy; the [-1] omits t</span></span>
<span id="cb12-2"><a href="discrete-time-deterministic.html#cb12-2" tabindex="-1"></a>xy[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">dts_xy_1</span>(xy, par)[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>##             x             y 
## -3.545225e-05 -1.355019e-04</code></pre>
<p>If we iterate another hundred days and check again, the differences are effectively zero.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="discrete-time-deterministic.html#cb14-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">41</span><span class="sc">:</span><span class="dv">140</span>){</span>
<span id="cb14-2"><a href="discrete-time-deterministic.html#cb14-2" tabindex="-1"></a>  xy <span class="ot">=</span> <span class="fu">dts_xy_1</span>(xy, par)</span>
<span id="cb14-3"><a href="discrete-time-deterministic.html#cb14-3" tabindex="-1"></a>  xy_t <span class="ot">=</span> <span class="fu">rbind</span>(xy_t, xy) </span>
<span id="cb14-4"><a href="discrete-time-deterministic.html#cb14-4" tabindex="-1"></a>} </span>
<span id="cb14-5"><a href="discrete-time-deterministic.html#cb14-5" tabindex="-1"></a>xy[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">dts_xy_1</span>(xy, par)[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>## x y 
## 0 0</code></pre>
<p>After simulating, the variables reach a steady state, where asymptotically <span class="math inline">\(x_{t+1} = x_t\)</span> and <span class="math inline">\(y_{t+1} = y_t\)</span>.</p>
</div>
<div id="analysis" class="section level3 hasAnchor" number="2.1.6">
<h3><span class="header-section-number">2.1.6</span> Analysis<a href="discrete-time-deterministic.html#analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can figure out the steady state values are by substituting <span class="math inline">\(x_{t+1} = x_t = x\)</span> and <span class="math inline">\(y_{t+1} = y_t = y\)</span> into the equations above, and then solving for <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<p><span class="math display">\[
\begin{array}{rl}
x &amp;=  x - s x + m a y (1-x)  \\
y &amp;=  y - u y + a x (1-y) \\
\end{array}
\]</span></p>
<p>or even easier:</p>
<p><span class="math display">\[\begin{array}{rl}
m a y (1-x) &amp;=  s x \\
a x (1 - y) &amp;=  u y\\
\end{array}\]</span></p>
<p>The most obvious solution to these equations is <span class="math inline">\(x=y=0,\)</span> which in these models means that there is no malaria. We call it the disease-free steady state. The equilibrium makes some sense: if there are no infected mosquitoes or infected humans in a deterministic model, there can never be any.</p>
<p>There is another solution where malaria is present. We solve the second equation first:</p>
<p><span class="math display">\[y = a x / (u + a x).\]</span></p>
<p>We can substitute this for <span class="math inline">\(x\)</span> into the first equation to get:</p>
<p><span class="math display">\[m a^2 (1-x) =  s (u+ax)\]</span>
and now we solve for <span class="math inline">\(x\)</span></p>
<p><span class="math display">\[x = \frac{\textstyle{ma^2 - su}}{\textstyle{ma^2 + sa}}\]</span>
We can write a function to compute this steady state:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="discrete-time-deterministic.html#cb16-1" tabindex="-1"></a><span class="co"># Compute the steady state </span></span>
<span id="cb16-2"><a href="discrete-time-deterministic.html#cb16-2" tabindex="-1"></a>find_eq_dts_1 <span class="ot">=</span> <span class="cf">function</span>(par){<span class="fu">with</span>(par,{</span>
<span id="cb16-3"><a href="discrete-time-deterministic.html#cb16-3" tabindex="-1"></a>  xx <span class="ot">=</span> (m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span> <span class="sc">-</span> s<span class="sc">*</span>u)<span class="sc">/</span> (m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> s<span class="sc">*</span>a)</span>
<span id="cb16-4"><a href="discrete-time-deterministic.html#cb16-4" tabindex="-1"></a>  yy <span class="ot">=</span> a<span class="sc">*</span>xx<span class="sc">/</span>(u<span class="sc">+</span>a<span class="sc">*</span>xx) </span>
<span id="cb16-5"><a href="discrete-time-deterministic.html#cb16-5" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">x=</span>xx,<span class="at">y=</span>yy)</span>
<span id="cb16-6"><a href="discrete-time-deterministic.html#cb16-6" tabindex="-1"></a>})}</span></code></pre></div>
</div>
<div id="verification" class="section level3 hasAnchor" number="2.1.7">
<h3><span class="header-section-number">2.1.7</span> Verification<a href="discrete-time-deterministic.html#verification" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We want to get used to double checking everything to avoid inserting mistakes. One way to do this is to find two or more ways of computing the same thing, for verification.</p>
<p>If we’ve done everything right, we ought to get the same values for the steady states through our analysis and simulation.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="discrete-time-deterministic.html#cb17-1" tabindex="-1"></a>xy[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>##         x         y 
## 0.9867987 0.7475000</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="discrete-time-deterministic.html#cb19-1" tabindex="-1"></a><span class="fu">find_eq_dts_1</span>(par) </span></code></pre></div>
<pre><code>##         x         y 
## 0.9867987 0.7475000</code></pre>
<p>It’s tempting to look at the printout and assume these two numbers are exactly equal. This is the land of computation, so things won’t be exact. We can simply sum up the absolute values of the differences:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="discrete-time-deterministic.html#cb21-1" tabindex="-1"></a>verify_dts_1 <span class="ot">=</span> <span class="cf">function</span>(xy, pars){</span>
<span id="cb21-2"><a href="discrete-time-deterministic.html#cb21-2" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">abs</span>(xy[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">find_eq_dts_1</span>(pars))) </span>
<span id="cb21-3"><a href="discrete-time-deterministic.html#cb21-3" tabindex="-1"></a>}</span>
<span id="cb21-4"><a href="discrete-time-deterministic.html#cb21-4" tabindex="-1"></a><span class="fu">verify_dts_1</span>(xy, par)</span></code></pre></div>
<pre><code>## [1] 3.330669e-16</code></pre>
<p>If we wanted to reduce this to a simple error check, we should pick a tolerance level – say <span class="math inline">\(10^{-9}\)</span> – and then just ask if we are closer than that:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="discrete-time-deterministic.html#cb23-1" tabindex="-1"></a>check_it_dts_1 <span class="ot">=</span> <span class="cf">function</span>(xy, pars, <span class="at">tol=</span><span class="fl">1e-9</span>)</span>
<span id="cb23-2"><a href="discrete-time-deterministic.html#cb23-2" tabindex="-1"></a>{</span>
<span id="cb23-3"><a href="discrete-time-deterministic.html#cb23-3" tabindex="-1"></a>  <span class="fu">verify_dts_1</span>(xy, pars) <span class="sc">&lt;</span> tol</span>
<span id="cb23-4"><a href="discrete-time-deterministic.html#cb23-4" tabindex="-1"></a>}</span>
<span id="cb23-5"><a href="discrete-time-deterministic.html#cb23-5" tabindex="-1"></a><span class="fu">check_it_dts_1</span>(xy, par)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="packaging-workflows" class="section level3 hasAnchor" number="2.1.8">
<h3><span class="header-section-number">2.1.8</span> Packaging Workflows<a href="discrete-time-deterministic.html#packaging-workflows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If we want to repeat tasks, we can simply write a wrapper around other functions that expedite the work. In this case, we want to write a function that <em>solves</em> the equations (<em>i.e.</em> that iteratively computes and stores the values) over some time interval:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="discrete-time-deterministic.html#cb25-1" tabindex="-1"></a>solve_dts_xy_1 <span class="ot">=</span> <span class="cf">function</span>(pars, <span class="at">x0=</span>.<span class="dv">01</span>, <span class="at">y0 =</span> <span class="fl">0.001</span>, <span class="at">tmax=</span><span class="dv">100</span>){</span>
<span id="cb25-2"><a href="discrete-time-deterministic.html#cb25-2" tabindex="-1"></a>   xy <span class="ot">=</span> <span class="fu">c</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">x=</span>x0, <span class="at">y=</span>y0) </span>
<span id="cb25-3"><a href="discrete-time-deterministic.html#cb25-3" tabindex="-1"></a>   xy_t <span class="ot">=</span> xy </span>
<span id="cb25-4"><a href="discrete-time-deterministic.html#cb25-4" tabindex="-1"></a>   <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>tmax){</span>
<span id="cb25-5"><a href="discrete-time-deterministic.html#cb25-5" tabindex="-1"></a>     xy <span class="ot">=</span> <span class="fu">dts_xy_1</span>(xy, pars)</span>
<span id="cb25-6"><a href="discrete-time-deterministic.html#cb25-6" tabindex="-1"></a>     xy_t <span class="ot">=</span> <span class="fu">rbind</span>(xy_t, xy)</span>
<span id="cb25-7"><a href="discrete-time-deterministic.html#cb25-7" tabindex="-1"></a>   }</span>
<span id="cb25-8"><a href="discrete-time-deterministic.html#cb25-8" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">t=</span>xy_t[,<span class="dv">1</span>], <span class="at">x=</span>xy_t[,<span class="dv">2</span>], <span class="at">y =</span> xy_t[,<span class="dv">3</span>], <span class="at">last =</span> xy)) </span>
<span id="cb25-9"><a href="discrete-time-deterministic.html#cb25-9" tabindex="-1"></a>}</span></code></pre></div>
<p>We can write another function that <em>plots</em> the equations (<em>i.e.</em> that iteratively computes and stores the values) over some time interval:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="discrete-time-deterministic.html#cb26-1" tabindex="-1"></a>plot_xy <span class="ot">=</span> <span class="cf">function</span>(xy_t, <span class="at">add_points =</span> <span class="cn">FALSE</span>){<span class="fu">with</span>(xy_t,{</span>
<span id="cb26-2"><a href="discrete-time-deterministic.html#cb26-2" tabindex="-1"></a>  llty <span class="ot">=</span> <span class="st">&quot;l&quot;</span></span>
<span id="cb26-3"><a href="discrete-time-deterministic.html#cb26-3" tabindex="-1"></a>  <span class="cf">if</span>(add_points <span class="sc">==</span> <span class="cn">TRUE</span>) llty <span class="ot">=</span> <span class="st">&quot;b&quot;</span></span>
<span id="cb26-4"><a href="discrete-time-deterministic.html#cb26-4" tabindex="-1"></a>  <span class="fu">plot</span>(t, x, <span class="at">type =</span> llty, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;x, y&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="at">pch=</span><span class="dv">15</span>)</span>
<span id="cb26-5"><a href="discrete-time-deterministic.html#cb26-5" tabindex="-1"></a>  <span class="fu">lines</span>(t, y, <span class="at">type =</span> llty, <span class="at">col =</span> <span class="st">&quot;darkorange&quot;</span>, <span class="at">pch =</span><span class="dv">19</span>)</span>
<span id="cb26-6"><a href="discrete-time-deterministic.html#cb26-6" tabindex="-1"></a>})}</span></code></pre></div>
<p>Now, all the work we did above can be plotted using a single function call:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="discrete-time-deterministic.html#cb27-1" tabindex="-1"></a><span class="fu">plot_xy</span>(<span class="fu">solve_dts_xy_1</span>(par, <span class="at">tmax=</span><span class="dv">40</span>), <span class="at">add_points=</span><span class="cn">TRUE</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Now, it is easier to use the models in various ways.</p>
</div>
<div id="thresholds" class="section level3 hasAnchor" number="2.1.9">
<h3><span class="header-section-number">2.1.9</span> Thresholds<a href="discrete-time-deterministic.html#thresholds" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All our analysis worked out well for the parameter values that we chose, but what if we had picked different parameters?</p>
<p>There must be some very low level of mosquitoes, for example, where malaria can’t reproduce. If we reduce <span class="math inline">\(m\)</span> to <span class="math inline">\(0.005\)</span> and evaluate the expression at the steady state, we get negative values for <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="discrete-time-deterministic.html#cb28-1" tabindex="-1"></a>par1 <span class="ot">=</span> par</span>
<span id="cb28-2"><a href="discrete-time-deterministic.html#cb28-2" tabindex="-1"></a>par1<span class="sc">$</span>m <span class="ot">=</span> <span class="fl">0.005</span></span>
<span id="cb28-3"><a href="discrete-time-deterministic.html#cb28-3" tabindex="-1"></a><span class="fu">find_eq_dts_1</span>(par1)</span></code></pre></div>
<pre><code>##           x           y 
## -0.06666667 -0.25000000</code></pre>
<p>What happens if we simulate this? (Let’s set the initial conditions to reasonably high values)</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="discrete-time-deterministic.html#cb30-1" tabindex="-1"></a><span class="fu">plot_xy</span>(<span class="fu">solve_dts_xy_1</span>(par1, <span class="at">x0 =</span> .<span class="dv">5</span>, <span class="at">y0=</span>.<span class="dv">3</span>, <span class="at">tmax=</span><span class="dv">1500</span>)) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>If we look at the equations, it’s easy enough to spot the problem. Since <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> must be positive, then it must be true that <span class="math display">\[m a^2 &gt; su.\]</span> We call this a threshold condition.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="discrete-time-deterministic.html#cb31-1" tabindex="-1"></a>m_crit <span class="ot">=</span> <span class="fu">with</span>(par, s<span class="sc">*</span>u<span class="sc">/</span>a<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb31-2"><a href="discrete-time-deterministic.html#cb31-2" tabindex="-1"></a>m_crit </span></code></pre></div>
<pre><code>## [1] 0.006666667</code></pre>
<p>If we check, we find that this gives us the disease free equilibrium.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="discrete-time-deterministic.html#cb33-1" tabindex="-1"></a>par2 <span class="ot">=</span> par</span>
<span id="cb33-2"><a href="discrete-time-deterministic.html#cb33-2" tabindex="-1"></a>par2<span class="sc">$</span>m <span class="ot">=</span> m_crit</span>
<span id="cb33-3"><a href="discrete-time-deterministic.html#cb33-3" tabindex="-1"></a><span class="fu">find_eq_dts_1</span>(par2)</span></code></pre></div>
<pre><code>## x y 
## 0 0</code></pre>
</div>
<div id="numerical-stability" class="section level3 hasAnchor" number="2.1.10">
<h3><span class="header-section-number">2.1.10</span> Numerical Stability<a href="discrete-time-deterministic.html#numerical-stability" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is another problem with the equations. If we set <span class="math inline">\(m\)</span> too high, such that at some point <span class="math inline">\(m a y_t &gt; 1,\)</span> then the whole system eventually crashes:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="discrete-time-deterministic.html#cb35-1" tabindex="-1"></a>par3 <span class="ot">=</span> par</span>
<span id="cb35-2"><a href="discrete-time-deterministic.html#cb35-2" tabindex="-1"></a>par3<span class="sc">$</span>m <span class="ot">=</span> <span class="dv">20</span> </span>
<span id="cb35-3"><a href="discrete-time-deterministic.html#cb35-3" tabindex="-1"></a><span class="fu">plot_xy</span>(<span class="fu">solve_dts_xy_1</span>(par3, <span class="at">x0 =</span> .<span class="dv">01</span>, <span class="at">y0=</span>.<span class="dv">001</span>, <span class="at">tmax=</span><span class="dv">20</span>)) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>In discrete time formulations, we must be very careful to ensure that we have formulated a proper model. How can we fix this problem? We have to go back to the assumption that the fraction getting infected is linearly proportional to the number of infective bites. One way to do this is to say that the <em>expected</em> number of bites would follow a Poisson distribution with mean <span class="math inline">\(may_t,\)</span> so that the fraction getting infected is the zero term from a Poisson:</p>
<p><span class="math display">\[1 - e^{-m a y_t}\]</span></p>
<p>Now, our equations are the following:</p>
<p><span class="math display">\[\begin{array}{rl}
x_{t+1} &amp;=  x_t - s x_t + (1-e^{m a y_t}) (1-x_t)  \\
y_{t+1} &amp;=  y_t - u y_t + a x_t (1 - y_t) \\
\end{array}\]</span></p>
<p>Now, if we want to compute the steady state, we’re stuck with the problem of solving this:</p>
<p><span class="math display">\[(1-e^{-m a^2 x/(u + a x)}) (1-x) = sx\]</span>
It’s surprisingly easy to write down equations, like this one, that we can’t solve with pencil and paper. We can still find a way of computing the steady state, but we have to write R code that solves for <span class="math inline">\(x\)</span> numerically.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="discrete-time-deterministic.html#cb36-1" tabindex="-1"></a>find_eq_dts_2 <span class="ot">=</span> <span class="cf">function</span>(pars){<span class="fu">with</span>(pars,{</span>
<span id="cb36-2"><a href="discrete-time-deterministic.html#cb36-2" tabindex="-1"></a>   f_xx <span class="ot">=</span> <span class="cf">function</span>(x, pp){<span class="fu">with</span>(pp,{</span>
<span id="cb36-3"><a href="discrete-time-deterministic.html#cb36-3" tabindex="-1"></a>     xx <span class="ot">=</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>m<span class="sc">*</span>a<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>x<span class="sc">/</span>(u<span class="sc">+</span>a<span class="sc">*</span>x)))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x) <span class="sc">-</span> s<span class="sc">*</span>x</span>
<span id="cb36-4"><a href="discrete-time-deterministic.html#cb36-4" tabindex="-1"></a>     y <span class="ot">=</span> a<span class="sc">*</span>xx<span class="sc">/</span>(u<span class="sc">+</span>a<span class="sc">*</span>xx)</span>
<span id="cb36-5"><a href="discrete-time-deterministic.html#cb36-5" tabindex="-1"></a>     yy <span class="ot">=</span> u<span class="sc">*</span>y <span class="sc">+</span> a<span class="sc">*</span>xx<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y) </span>
<span id="cb36-6"><a href="discrete-time-deterministic.html#cb36-6" tabindex="-1"></a>     <span class="fu">return</span>(xx<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> yy<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb36-7"><a href="discrete-time-deterministic.html#cb36-7" tabindex="-1"></a>   })}</span>
<span id="cb36-8"><a href="discrete-time-deterministic.html#cb36-8" tabindex="-1"></a>   xx <span class="ot">=</span> <span class="fu">optimize</span>(f_xx, <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">pp=</span>pars)<span class="sc">$</span>min</span>
<span id="cb36-9"><a href="discrete-time-deterministic.html#cb36-9" tabindex="-1"></a>   yy <span class="ot">=</span> a<span class="sc">*</span>xx<span class="sc">/</span>(u<span class="sc">+</span>a<span class="sc">*</span>xx) </span>
<span id="cb36-10"><a href="discrete-time-deterministic.html#cb36-10" tabindex="-1"></a>   <span class="fu">c</span>(xx, yy)</span>
<span id="cb36-11"><a href="discrete-time-deterministic.html#cb36-11" tabindex="-1"></a>})}</span></code></pre></div>
<p>The new equilibrium is at:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="discrete-time-deterministic.html#cb37-1" tabindex="-1"></a><span class="fu">find_eq_dts_2</span>(par3)</span></code></pre></div>
<pre><code>## [1] 0.9949026 0.7490406</code></pre>
<p>We can just as easily write the code to numerically solve the discrete time system:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="discrete-time-deterministic.html#cb39-1" tabindex="-1"></a>dts_xy_2 <span class="ot">=</span> <span class="cf">function</span>(xy, p){<span class="fu">with</span>(<span class="fu">as.list</span>(xy), <span class="fu">with</span>(p,{</span>
<span id="cb39-2"><a href="discrete-time-deterministic.html#cb39-2" tabindex="-1"></a>  xn <span class="ot">=</span> x <span class="sc">-</span> s<span class="sc">*</span>x <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>m<span class="sc">*</span>a<span class="sc">*</span>y))<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x) </span>
<span id="cb39-3"><a href="discrete-time-deterministic.html#cb39-3" tabindex="-1"></a>  yn <span class="ot">=</span> y <span class="sc">-</span> u<span class="sc">*</span>y <span class="sc">+</span> a<span class="sc">*</span>x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y) </span>
<span id="cb39-4"><a href="discrete-time-deterministic.html#cb39-4" tabindex="-1"></a>  t<span class="ot">=</span>t<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb39-5"><a href="discrete-time-deterministic.html#cb39-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">t=</span>t, <span class="at">x=</span>xn, <span class="at">y=</span>yn))</span>
<span id="cb39-6"><a href="discrete-time-deterministic.html#cb39-6" tabindex="-1"></a>}))}</span></code></pre></div>
<p>Once again, we can wrap a function around the solver so that it’s easier to use the code:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="discrete-time-deterministic.html#cb40-1" tabindex="-1"></a>solve_dts_xy_2 <span class="ot">=</span> <span class="cf">function</span>(pars, <span class="at">x0=</span>.<span class="dv">01</span>, <span class="at">y0 =</span> <span class="fl">0.001</span>, <span class="at">tmax=</span><span class="dv">100</span>){</span>
<span id="cb40-2"><a href="discrete-time-deterministic.html#cb40-2" tabindex="-1"></a>   xy <span class="ot">=</span> <span class="fu">c</span>(<span class="at">t=</span><span class="dv">0</span>, <span class="at">x=</span>x0, <span class="at">y=</span>y0) </span>
<span id="cb40-3"><a href="discrete-time-deterministic.html#cb40-3" tabindex="-1"></a>   xy_t <span class="ot">=</span> xy </span>
<span id="cb40-4"><a href="discrete-time-deterministic.html#cb40-4" tabindex="-1"></a>   <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>tmax){</span>
<span id="cb40-5"><a href="discrete-time-deterministic.html#cb40-5" tabindex="-1"></a>     xy <span class="ot">=</span> <span class="fu">dts_xy_2</span>(xy, pars)</span>
<span id="cb40-6"><a href="discrete-time-deterministic.html#cb40-6" tabindex="-1"></a>     xy_t <span class="ot">=</span> <span class="fu">rbind</span>(xy_t, xy)</span>
<span id="cb40-7"><a href="discrete-time-deterministic.html#cb40-7" tabindex="-1"></a>   }</span>
<span id="cb40-8"><a href="discrete-time-deterministic.html#cb40-8" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">t=</span>xy_t[,<span class="dv">1</span>], <span class="at">x=</span>xy_t[,<span class="dv">2</span>], <span class="at">y =</span> xy_t[,<span class="dv">3</span>], <span class="at">last =</span> xy)) </span>
<span id="cb40-9"><a href="discrete-time-deterministic.html#cb40-9" tabindex="-1"></a>}</span></code></pre></div>
<p>Now, we can visualize the output and see that we have fixed our stability problem.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="discrete-time-deterministic.html#cb41-1" tabindex="-1"></a><span class="fu">plot_xy</span>(<span class="fu">solve_dts_xy_2</span>(par3, <span class="at">x0 =</span> .<span class="dv">01</span>, <span class="at">y0=</span>.<span class="dv">001</span>, <span class="at">tmax=</span><span class="dv">20</span>)) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="discrete-time-deterministic.html#cb42-1" tabindex="-1"></a><span class="fu">find_eq_dts_2</span>(par3)</span></code></pre></div>
<pre><code>## [1] 0.9949026 0.7490406</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="discrete-time-deterministic.html#cb44-1" tabindex="-1"></a><span class="fu">solve_dts_xy_2</span>(par3, <span class="at">x0=</span>.<span class="dv">1</span>, <span class="at">y0=</span>.<span class="dv">05</span>,<span class="at">tmax=</span><span class="dv">300</span>)<span class="sc">$</span>last[<span class="sc">-</span><span class="dv">1</span>]</span></code></pre></div>
<pre><code>##         x         y 
## 0.9949051 0.7490410</code></pre>
<p>Once again, we want to ensure that our code does not have any mistakes, so we write a function to verify our results.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="discrete-time-deterministic.html#cb46-1" tabindex="-1"></a>verify_dts_2 <span class="ot">=</span> <span class="cf">function</span>(pars, <span class="at">x0 =</span> .<span class="dv">1</span>, <span class="at">y0=</span>.<span class="dv">05</span>, <span class="at">tmax=</span><span class="dv">200</span>){</span>
<span id="cb46-2"><a href="discrete-time-deterministic.html#cb46-2" tabindex="-1"></a>  xyt <span class="ot">=</span> <span class="fu">solve_dts_xy_2</span>(pars, <span class="at">x0=</span>x0, <span class="at">y0=</span>y0, <span class="at">tmax=</span>tmax)</span>
<span id="cb46-3"><a href="discrete-time-deterministic.html#cb46-3" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">abs</span>(xyt<span class="sc">$</span>last[<span class="sc">-</span><span class="dv">1</span>] <span class="sc">-</span> <span class="fu">find_eq_dts_2</span>(pars))) </span>
<span id="cb46-4"><a href="discrete-time-deterministic.html#cb46-4" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="discrete-time-deterministic.html#cb47-1" tabindex="-1"></a><span class="fu">verify_dts_2</span>(par3, <span class="at">tmax=</span><span class="dv">300</span>)</span></code></pre></div>
<pre><code>## [1] 2.924525e-06</code></pre>
<p>A function to check that it is accurate to some level of tolerance, but the numerical precision is mismatched, somehow.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="discrete-time-deterministic.html#cb49-1" tabindex="-1"></a>check_it_dts_2 <span class="ot">=</span> <span class="cf">function</span>(pars, <span class="at">x0 =</span> .<span class="dv">1</span>, <span class="at">y0=</span>.<span class="dv">05</span>, <span class="at">tmax=</span><span class="dv">200</span>, <span class="at">tol=</span><span class="fl">1e-5</span>)</span>
<span id="cb49-2"><a href="discrete-time-deterministic.html#cb49-2" tabindex="-1"></a>{</span>
<span id="cb49-3"><a href="discrete-time-deterministic.html#cb49-3" tabindex="-1"></a>  <span class="fu">verify_dts_2</span>(pars, x0, y0, tmax) <span class="sc">&lt;</span> tol</span>
<span id="cb49-4"><a href="discrete-time-deterministic.html#cb49-4" tabindex="-1"></a>}</span>
<span id="cb49-5"><a href="discrete-time-deterministic.html#cb49-5" tabindex="-1"></a><span class="fu">check_it_dts_2</span>(par3, <span class="at">tmax=</span><span class="dv">200</span>)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="notes" class="section level3 hasAnchor" number="2.1.11">
<h3><span class="header-section-number">2.1.11</span> Notes<a href="discrete-time-deterministic.html#notes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Some useful notes:</p>
<ol style="list-style-type: decimal">
<li><p>The two models we just presented above can be implemented in a spreadsheet.</p></li>
<li></li>
</ol>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basic-malaria-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="continuous-time-deterministic.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
